# Передатчик и Приемник данных

## Передатчик

### 1. Инициализация:
1. Настраиваются пины для передачи данных, сигнала часов и получения подтверждения (ACK).
2. Преобразуется исходное сообщение в массив байтов, добавляя контрольный бит четности к каждому байту.

### 2. Преобразование данных:
1. **ConvertDataToBits**: Функция берет исходное сообщение и преобразует его в массив байтов, где каждый байт дополняется битом четности. Бит четности рассчитывается путем выполнения операции XOR над всеми битами байта.

### 3. Передача данных:
1. В функции `loop` последовательно передаются биты данных. Для каждого бита:
   - Устанавливается значение пина для передачи данных в соответствии с текущим битом.
   - Сигнал часов устанавливается в HIGH и затем в LOW, чтобы передать один бит данных.
2. После передачи каждого байта (8 бит данных + 1 бит четности) передатчик ждет подтверждение (ACK) от приемника.
3. Если подтверждение получено, передатчик переходит к следующему байту.

## Приемник

### 1. Инициализация:
1. Настраиваются пины для получения данных, сигнала часов и отправки подтверждения (ACK).
2. Настраивается прерывание на фронт сигнала часов для вызова функции `Append_Bit`.

### 2. Прием данных:
1. В функции `loop` считывается текущий бит данных.
2. **Append_Bit**: Функция, вызываемая при каждом прерывании сигнала часов, обрабатывает принятый бит:
   - Бит добавляется в буфер.
   - Когда буфер заполнен (9 бит: 8 бит данных + 1 бит четности), происходит проверка четности.
   - Если контрольный бит совпадает с вычисленным, байт данных сохраняется и выводится через Serial.
   - После успешного приема байта данных отправляется сигнал подтверждения (ACK) передатчику.

## Принцип работы системы в целом:

### 1. Передача байта:
1. Передатчик берет байт данных, добавляет к нему бит четности и передает его по одному биту, используя лазерный луч.
2. Каждый бит передается в синхронизации с сигналом часов.

### 2. Прием байта:
1. Приемник принимает каждый бит, синхронизируясь с сигналом часов, и сохраняет его в буфер.
2. Когда буфер заполнен (9 бит), проверяется контрольный бит четности.
3. Если четность совпадает, байт данных считается принятым и отправляется подтверждение (ACK) передатчику.

### 3. Обратная связь:
1. Передатчик ждет подтверждение (ACK) от приемника после отправки каждого байта.
2. Если подтверждение получено, передатчик переходит к следующему байту данных.

## Версии проекта

### Stable
В файлах версии `stable` реализован самый простой алгоритм передачи данных.

### ACK and Error Detection
В файлах версии `ack_errordetect` реализована передача данных с ACK и подсчетом контрольного бита.

### Keyboard Test
В файлах версии `keyboardtest` реализована попытка передачи данных с клавиатуры и их отображение на TFT дисплее. Это самая нестабильная версия, возможны ошибки (может быть бабах).
